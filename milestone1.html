<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Milestone 1</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </head>
  
  <style>
    .jumbotron { 
        background-color: #000000; /* Black */
        background-image: url(https://i.imgur.com/6mI80iZ.jpg);
        background-size: cover;
        background-repeat: no-repeat;  
        color: #FFFB00; /* Yellow */
        height: 100vh;
        padding: 100px 25px;
        align-items: center;
    }
    
    .container-fluid {
        padding: 60px 50px;
    }
    
    .bg-blk {
        background-color: #000000;
    }
    
    .txt-white {
        color: #fff;
    }
    
    .txt-yellow {
        color: #FFFB00;
    }
    
    .navbar {
        margin-bottom: 0;
        background-color: #000;
        z-index: 9999;
        border: 0;
        font-size: 12px !important;
        line-height: 1.42857143 !important;
        letter-spacing: 4px;
        border-radius: 0;
    }
    .navbar li a, .navbar .navbar-brand {
        color: #FFFB00 !important;
    }
    .navbar-nav li a:hover, .navbar-nav li.active a {
        color: #000 !important;
        background-color: #FFFB00 !important;
    }
    .navbar-default .navbar-toggle {
        border-color: transparent;
        color: #FFFB00 !important;
    }

    header .glyphicon {
        font-size: 20px;
        margin-bottom: 0px;
        color: #FFFB00;
        background-color: transparent;
    }
    
    footer .glyphicon {
        font-size: 20px;
        margin-bottom: 20px;
        color: #FFFB00;
    }
    body {
        cursor: url(https://github.com/sk2282/ECE3400_Team8/blob/master/pictures/General/bb-8_cursor.png?raw=true), auto;
    }
    a {
       color: #FFFF00;
    }
    a:hover, a:focus {
      color: #FFFF00;
      text-decoration: underline;
      cursor: url(https://github.com/sk2282/ECE3400_Team8/blob/master/pictures/General/LightSaber_Blue.cur?raw=true), auto;
    }
</style>

  <body>
  
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span> 
          </button>
          <a class="navbar-brand" href="#myPage">
            <span class="glyphicon glyphicon-king"></span>
          </a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://sk2282.github.io/ECE3400_Team8/">HOME</a></li>
            
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">MILESTONES
              <span class="caret"></span></a>
              <ul class="dropdown-menu bg-blk">
                <li><a href="https://sk2282.github.io/ECE3400_Team8/milestone2">Milestone 2</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/milestone3">Milestone 3</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/milestone4">Milestone 4</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">LABS
              <span class="caret"></span></a>
              <ul class="dropdown-menu bg-blk">
                <li><a href="https://sk2282.github.io/ECE3400_Team8/lab1">Lab 1</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/lab2">Lab 2</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/lab3">Lab 3</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/lab4">Lab 4</a></li>
              </ul>
            </li>     
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">LINKS
              <span class="caret"></span></a>
              <ul class="dropdown-menu bg-blk">
                <li><a href="https://github.com/sk2282/ECE3400_Team8">GitHub</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/minutes">Meeting Minutes</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/ethics">Ethics Homework</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/cost">Robot Cost</a></li>
                <li><a href="https://www.sparkfun.com/products/9453">Line Sensor Info</a></li>
                <li><a href="https://www.fairchildsemi.com/datasheets/LM/LM358A.pdf">Op Amp Data Sheet</a></li>
              </ul>
            </li> 

            <li><a href="https://sk2282.github.io/ECE3400_Team8/final">DESIGN</a></li>                
          </ul>

        </div>
      </div>
    </nav>
  
    <!--TITLE-->
    <div id="myPage" class="jumbotron text-center">
      <br><br><br><br><br><br><br><br><br><br>
      <br><br><br>
      <!--<h1>MILESTONE</h1> -->
      <p><i>LINE FOLLOWING AND FIGURE 8</i></p> 
      <div class="container">
          <header class="container-fluid text-center">
            <a href="#content" title="Enter">
              <span class="glyphicon glyphicon-chevron-down"></span>
            </a> 
          </header>
      </div> 
    </div>
    
    <!--THIS IS WHERE THE TEXT WILL GO-->
    <div id="content" class="container-fluid bg-blk txt-white">
      <div class="row">
        
      <!--start-->
      <h4>Objective:</h4>
      The goal of this milestone is to implement line following and turning functionalities to our robot.

      <h4>Line Following:</h4>
        <ul>
          <li>The first step was to have our robot <a href="https://youtu.be/ZP58UEu52JQ">follow a line of black tape</a></li>
          <li>We used 2 IR sensors to detect the black line by determining a threshold value</li>
          <li>If a sensor went out of line, the corresponding servo would compensate by speeding up that side of the wheel so that the robot would remain on the line 
            <ul>
                <li>If left sensor went out of line, speed up left servos  </li>
                <li>If right sensor went out of line, speed up right servos  </li>
                <li>Otherwise, servos rotate at same rate</li>
            </ul>  
            <pre>
             if(lRead&lt;thresh){  // left side is out of line
                  left.write(170);
                  right.write(86);
                }
                else if(rRead&lt;thresh){   // right side is out of line
                  left.write(94);
                  right.write(10);
                }
                else{     // go straight
                  left.write(100);
                  right.write(80);
            </pre>
          </li>

          <li>We tested the robot on a <a href="https://youtu.be/l7fE-NlZAs8">curved line</a> as well</li>
        </ul>

      <h4>Figure-8:</h4>
      <h5>Detecting Intersections:</h5>
        <ul>
          <li>Our next step was to add two additional sensors to detect an intersection</li>
          <li>We added two wide sensors near the wheels, one on each side of the robot</li>
          <li>When either wide sensor detected black, we detect an intersection</li>
        </ul>

      <h5>Figure-8 Implementation:</h5>
        <ul>
          <li>We then implemented <a href="https://youtu.be/I4GyVfHf1CU">turning</a>  

            <pre>
            void leftTurn(){
              while(analogRead(0)>=thresh || analogRead(1)>=thresh){
                  right.write(77);
                  left.write(77);
              }while(analogRead(0)&lt;=thresh){
                  right.write(77);
                  left.write(77);
              }
              right.write(90);
              left.write(90);
            }

            void rightTurn(){
              while(analogRead(0)&gt;=thresh || analogRead(1)&gt;=thresh){
                  right.write(103);
                  left.write(103);
              }while(analogRead(1)&lt;=thresh){
                  right.write(103);
                  left.write(103);
              }
              right.write(90);
              left.write(90);
            }
            </pre>
          </li>

          <li>When the robot detected an intersection, we programmed it to turn until the line/inner sensors detected black again (turn is finished)</li>
          <li>To implement the figure 8, we programmed the robot to turn left whenever it detects an intersection 3 times, go straight at the next intersection, and turn right when it detects an intersection 3 times. This sequence is in a loop, so the robot continues to navigate a <a href="https://youtu.be/NztFPuQvlM0">figure 8</a></li>
          <li>To go straight we added a helper function goStraight():

            <pre>
            void goStraight(){
              while(analogRead(2)&gt;=thresh || analogRead(3)&gt;=thresh){
                left.write(100);
                right.write(80);  
              }
            }
            </pre>
          </li>

          <li>The code below shows the first few cases that we loop through while traversing the figure 8.  Notice we used a cooldown to ensure that the robot doesn't detect the same intersection more than once.

            <pre>
            int detectCooldown = 0;
            int DETECT_COOLDOWN = 50;
            .
            .
            .
             if((lwRead &gt;= thresh || rwRead &gt;= thresh) && detectCooldown == 0){
                switch (intsec){
                  case 0:
                    Serial.println("Case0");
                    intsec++;
                    detectCooldown = DETECT_COOLDOWN;
                    roboStop = 0;
                    goStraight();
                  break;
                  case 1:
                    Serial.println("Case1");
                    intsec++;
                    detectCooldown = DETECT_COOLDOWN;
                    roboStop = 0;
                    leftTurn();
                  break;
                  case 2:
                    Serial.println("Case2");
                    intsec++;
                    detectCooldown = DETECT_COOLDOWN;
                    roboStop = 0;
                    leftTurn();
                  break;
            </pre>
          </li>
        </ul>

      <h4>Final Robot of Milestone 1:</h4>
      <img src="https://github.com/sk2282/ECE3400_Team8/blob/master/pictures/Milestone1/final.JPG?raw=true" height="300" />

      </div>
    </div>
    
    <footer class="container-fluid text-center bg-blk txt-white">
      <a href="#myPage" title="To Top">
        <span class="glyphicon glyphicon-chevron-up"></span>
      </a>
      <p><small>Theme Made By <a href="https://github.com/sk2282/ECE3400_Team8">ECE 3400 Team 8</a> and <a href="https://www.w3schools.com" title="Visit w3schools">www.w3schools.com</a></small></p> 
    </footer>

    <!-- SMOOTH SCROLL -->
    <script>
      $(document).ready(function(){
        // Add smooth scrolling to all links in navbar + footer link
        $(".navbar a, footer a[href='#myPage'], header a[href='#content']").on('click', function(event) {

         // Make sure this.hash has a value before overriding default behavior
        if (this.hash !== "") {

          // Prevent default anchor click behavior
          event.preventDefault();

          // Store hash
          var hash = this.hash;

          // Using jQuery's animate() method to add smooth page scroll
          // The optional number (900) specifies the number of milliseconds it takes to scroll to the specified area
          $('html, body').animate({
            scrollTop: $(hash).offset().top
          }, 900, function(){

            // Add hash (#) to URL when done scrolling (default click behavior)
            window.location.hash = hash;
            });
          } // End if
        });
      })
    </script>
    
  </body>
  
</html>
