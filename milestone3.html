<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Milestone 3</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  </head>
  
  <style>
    h1,h2,h3 {
      color: #FFFF00;
    }
    .jumbotron { 
        background-color: #000000; /* Black */
        background-image: url(https://i.imgur.com/XUaOP3k.jpg);
        background-size: cover;
        background-repeat: no-repeat;  
        color: #FFFB00; /* Yellow */
        height: 100vh;
        padding: 100px 25px;
        align-items: center;
    }
    
    .container-fluid {
        padding: 60px 50px;
    }
    
    .bg-blk {
        background-color: #000000;
    }
    
    .txt-white {
        color: #fff;
    }
    
    .txt-yellow {
        color: #FFFB00;
    }
    
    .navbar {
        margin-bottom: 0;
        background-color: #000;
        z-index: 9999;
        border: 0;
        font-size: 12px !important;
        line-height: 1.42857143 !important;
        letter-spacing: 4px;
        border-radius: 0;
    }
    .navbar li a, .navbar .navbar-brand {
        color: #FFFB00 !important;
    }
    .navbar-nav li a:hover, .navbar-nav li.active a {
        color: #000 !important;
        background-color: #FFFB00 !important;
    }
    .navbar-default .navbar-toggle {
        border-color: transparent;
        color: #FFFB00 !important;
    }

    header .glyphicon {
        font-size: 20px;
        margin-bottom: 0px;
        color: #FFFB00;
        background-color: transparent;
    }
    
    footer .glyphicon {
        font-size: 20px;
        margin-bottom: 20px;
        color: #FFFB00;
    }
    body {
      background-color: #000;
        cursor: url(https://github.com/sk2282/ECE3400_Team8/blob/master/pictures/General/bb-8_cursor.png?raw=true), auto;
    }
    a {
       color: #FFFF00;
    }
    a:hover, a:focus {
      color: #FFFF00;
      text-decoration: underline;
      cursor: url(https://github.com/sk2282/ECE3400_Team8/blob/master/pictures/General/LightSaber_Blue.cur?raw=true), auto;
    }
</style>

  <body>
  
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span> 
          </button>
          <a class="navbar-brand" href="#myPage">
            <span class="glyphicon glyphicon-king"></span>
          </a>
        </div>
        <div class="collapse navbar-collapse" id="myNavbar">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://sk2282.github.io/ECE3400_Team8/">HOME</a></li>
            
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">MILESTONES
              <span class="caret"></span></a>
              <ul class="dropdown-menu bg-blk">
                <li><a href="https://sk2282.github.io/ECE3400_Team8/milestone1">Milestone 1</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/milestone2">Milestone 2</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/milestone4">Milestone 4</a></li>
              </ul>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">LABS
              <span class="caret"></span></a>
              <ul class="dropdown-menu bg-blk">
                <li><a href="https://sk2282.github.io/ECE3400_Team8/lab1">Lab 1</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/lab2">Lab 2</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/lab3">Lab 3</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/lab4">Lab 4</a></li>
              </ul>
            </li>   
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#">LINKS
              <span class="caret"></span></a>
              <ul class="dropdown-menu bg-blk">
                <li><a href="https://github.com/sk2282/ECE3400_Team8">GitHub</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/minutes">Meeting Minutes</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/ethics">Ethics Homework</a></li>
                <li><a href="https://sk2282.github.io/ECE3400_Team8/cost">Robot Cost</a></li>
                <li><a href="https://www.sparkfun.com/products/9453">Line Sensor Info</a></li>
                <li><a href="https://www.fairchildsemi.com/datasheets/LM/LM358A.pdf">Op Amp Data Sheet</a></li>
              </ul>
            </li>

            <li><a href="https://sk2282.github.io/ECE3400_Team8/final">DESIGN</a></li>                   
          </ul>

        </div>
      </div>
    </nav>
  
    <!--TITLE-->
    <div id="myPage" class="jumbotron text-center">
      <br><br><br><br><br><br><br><br><br><br>
      <br><br><br>
      <!--<h1>MILESTONE</h1> -->
      <p><i>MAZE NAVIGATION ALGORITHM</i></p> 
      <div class="container">
          <header class="container-fluid text-center">
            <a href="#content" title="Enter">
              <span class="glyphicon glyphicon-chevron-down"></span>
            </a> 
          </header>
      </div>
    </div>
    
    <!--THIS IS WHERE THE TEXT WILL GO-->
    <div style="padding:0 10%">
    <div id="content" class="container-fluid bg-blk txt-white">
      <div class="row">
        
      <!--start-->
      <h4>Objective:</h4>
      The goal of this milestone is to begin developing an algorithm for mave navigation by first simulating our algorithm in MATLAB and then moving it to the robot.

      <h4>MATLAB Simulation</h4>

      <h5>Version 1</h5>
          <ul>
              <li>First, we implemented a solution similar to Team Alpha, where we use a DFS to navigate the maze.</li>  
              <li>We first found a stack implementation for MATLAB <a href="https://www.mathworks.com/matlabcentral/fileexchange/28922-list--queue--stack?focused=5187765&tab=function">online</a>.</li>
              <li>We use a 5x4 matrix to keep track of which squares the robot has visited, and we use a stack to traverse the maze.  </li>
              <li>We push maze coordinates to the stack to keep track of the robot’s path and pop coordinates from the stack when we want the robot to retrace its steps (e.g. to go back to an intersection that has unexplored forks).  The robot knows it’s done (prints ‘done’) when it tries to pop from an empty stack.  This means the robot will always go back to the start square before stopping the algorithm.</li>
              <li>For this version of the algorithm, we determine the direction the robot will go in by checking in this order: North, South, East, then West.

                  <pre>
                  if (r &gt; 1 && wall_bin(1) ~= 1 && curr_loc(r-1,c) ~= 0.5) % NORTH wall
                      curr_loc(r-1,c) = 0; % set new curr location
                      hold on; imagesc(curr_loc); draw_walls(detected_wall_loc); % display new current location
                      pause(0.5);
                      visited(r-1,c) = 0.5; % set new visited
                      curr_loc(r-1,c) = 0.5;
                      loc=loc-4;
                      s.push(loc);
                      r = r-1;
                  elseif (r &lt; 5 && wall_bin(2) ~= 1 && curr_loc(r+1,c) ~= 0.5) % SOUTH wall
                    % not including rest of code for sake of briefness
                  elseif (c&gt;4 && wall_bin(3) ~= 1 && curr_loc(r,c+1) ~= 0.5) % EAST wall
                    % ...
                  elseif (c&gt;1 && wall_bin(4) ~= 1 && curr_loc(r,c-1) ~= 0.5) % WEST wall
                    % ...
                  </pre>
              </li>

              <li><a href="https://youtu.be/MxFL3VIOMlE">The first simulation displays the whole maze, and the robot maps it and ends where it started.</a></li>
              <li>Below is a diagram showing a coordinate system and how we index the squares in our maze from 0 to 19.
              <br>
              <img src="https://github.com/sk2282/ECE3400_Team8/blob/master/pictures/Milestone3/Milestone3Coord.png?raw=true" height="200" /></li>
          </ul>

      <h5>Version 2</h5>
          <ul>
              <li>Next, we tried to make it so the robot doesn’t have to go back to the start to know when it’s traversed all navigable area in the maze. </li> 
              <li>To do this, we created a separate 5x4 array that keeps track of the walls as the robot sees it.  </li>
              <li>Whenever the robot moves to a new square, this array gets updated.  </li>
              <li>If there exists a visited square that is adjacent to an unvisited square, and there is no wall between these squares, the robot will continue to search the maze.  Otherwise, it has visited all visitable squares and stops navigating.

                  <pre>
                  function notDone = notDone(visited, wall_loc)
                  % Returns true if the robot is done navigating, false otherwise
                      notDone = false;
                      for r = 1:5
                          for c = 1:4
                              wall_bin = de2bi(wall_loc(r,c), 4, 'right-msb');
                              if (visited(r,c) == 1)
                                  if ((wall_bin(1) == 0 && r &gt; 1 && visited(r-1,c) == 0.5) || ...
                                       (wall_bin(2) == 0 && r &lt; 5 && visited(r+1,c) == 0.5) || ...
                                       (wall_bin(3) == 0 && c &lt; 4 && visited(r,c+1) == 0.5) || ...
                                       (wall_bin(4) == 0 && c &gt; 1 && visited(r,c-1) == 0.5))
                                      notDone = true;
                                  end
                              end
                          end
                      end
                  end
                  </pre>
                  </li>

              <li><a href="https://youtu.be/MUISAKUdXKQ">This version of the simulation has the robot stop once it's finished mapping all explorable area.</a></li>
          </ul>


      <h5>Final Version of Simulation</h5>
          <ul>
              <li>Finally, we tried to tweak the algorithm slightly to more accurately simulate the robot’s movements. </li> 
              <li>In prior steps, the robot determines where to go knowing where every wall is.  </li>
              <li>At any given time, however, the robot can only know the locations of the walls bordering the squares it has visited as well as the walls surrounding the 5x4 maze.  So we created another 5x4 array to keep track of the walls known to the robot. We update this array every time the robot moves to a previously unvisited square.</li>
              <li><a href="https://youtu.be/FBHg2GErlwE">Now, this simulation displays the maze as the robot maps it.</a></li>
          </ul>

      <h4>Real-time Maze Mapping</h4>
          <ul>
              <li>After finishing our simulation, we began working on our algorithm for real-time maze mapping. Our algorithm remained the same, but we just added code to integrate the robot.</li>
              <li>We used code from before for line-following and turning, as well as for wall detection.</li>
              <li>Now, our robot should map the maze in real-time and print "DONE" in the serial monitor when finished.</li>
              <li>However, after rebuilding the robot and testing the code, the robot follows a line until an intersection and does not continue moving after detecting the walls on its sides.</li>
          </ul>

      <h4>Fixes for the Future</h4>
          <ul>
              <li>Since we may have complicated our code by checking for all of the walls while exploring the maze, we want to make sure that the robot can move forward until it detects a wall in front of it and act accordingly (turning left or right).</li>
              <li>We originally built Schmitt triggers a few weeks ago, however due to lack of documentation, we rebuilt them. This time we built the inverting Schmitt trigger since there was an easy tutorial. This means that when a wall is detected, it will output low, and when it does not detect a wall it will output high. In the future, we would like to go back to the non-inverting Schmitt triggers.</li>
          </ul>

      </div>
    </div>
    
    <footer class="container-fluid text-center bg-blk txt-white">
      <a href="#myPage" title="To Top">
        <span class="glyphicon glyphicon-chevron-up"></span>
      </a>
      <table style="border-style:none" width="100%" height="100px">
      <tr>
        <td width="35%" />
        <td width="30%">
          <p>
            <img src="https://raw.githubusercontent.com/sk2282/ECE3400_Team8/master/pictures/General/BB-8.png" style="height:52px" align:"left" />
            Site maintained by <a href="https://github.com/sk2282/ECE3400_Team8">ECE 3400 Team 8</a>
            <br><br>
            Theme Made Using <a href="http://getbootstrap.com/"> Bootstrap</a>
          </p>
        </td>
        <td width="35%" />
      </tr>
    </footer>

    <!-- SMOOTH SCROLL -->
    <script>
      $(document).ready(function(){
        // Add smooth scrolling to all links in navbar + footer link
        $(".navbar a, footer a[href='#myPage'], header a[href='#content']").on('click', function(event) {

         // Make sure this.hash has a value before overriding default behavior
        if (this.hash !== "") {

          // Prevent default anchor click behavior
          event.preventDefault();

          // Store hash
          var hash = this.hash;

          // Using jQuery's animate() method to add smooth page scroll
          // The optional number (900) specifies the number of milliseconds it takes to scroll to the specified area
          $('html, body').animate({
            scrollTop: $(hash).offset().top
          }, 900, function(){

            // Add hash (#) to URL when done scrolling (default click behavior)
            window.location.hash = hash;
            });
          } // End if
        });
      })
    </script>
    
  </body>
  
</html>
